<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ATV/UTV Adventure Packages</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .package-card { border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; transition: transform 0.2s; }
    .package-card:hover { transform: translateY(-5px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    .package-image { height: 180px; object-fit: cover; width: 100%; }
    .package-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem; }
    .package-price { font-weight: 500; color: #333; margin-bottom: 1rem; }
    .btn-add-cart { border-radius: 25px; padding: 0.5rem 1.2rem; font-weight: 500; }
    .booking-summary { max-height: 400px; overflow-y: auto; }
    .remove-item { cursor: pointer; color: #dc3545; }
    @media (max-width: 576px) {
      .package-card { margin-bottom: 20px; }
    }
    /* Hide the template card */
    #package-template { display: none; }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="container py-5">
  <h2 class="mb-4">ATV/UTV Adventure Packages</h2>
  <div class="row g-4" id="packageContainer">
    <div class="col-md-6 col-lg-4" id="package-template">
      <div class="package-card bg-white p-3">
        <img src="https://xadventurebandarban.com/storage/packages/NETtSgB6a0ZMXLYSa5kl4PRef0OM5HUsruEWaaTd.jpg" alt="Explorer Adventure" class="package-image mb-3">
        <div class="package-title">Explorer Adventure</div>
        <div class="package-description mb-1">Day Trip for 1â€“3 Riders</div>
        <div class="package-price mb-2">Starting from BDT 13,900</div>

        <label for="riders_TPL" class="form-label">Select Riders:</label>
        <select class="form-select mb-2" id="riders_TPL">
          <option value="1">1 Rider</option>
          <option value="2">2 Riders</option>
          <option value="3">3 Riders</option>
        </select>

        <label for="date_TPL" class="form-label">Select Date:</label>
        <input type="date" class="form-control mb-2" id="date_TPL" min="<?= new Date().toISOString().split('T')[0] ?>">

        <label for="time_TPL" class="form-label">Select Time Slot:</label>
        <select class="form-select mb-3" id="time_TPL">
          <option value="09:00 AM">09:00 AM</option>
          <option value="12:00 PM">12:00 PM</option>
          <option value="03:00 PM">03:00 PM</option>
          <option value="06:00 PM">06:00 PM</option>
        </select>

        <button class="btn btn-outline-danger w-100 btn-add-cart" onclick="addToCart('Explorer Adventure', 13900, 'riders_TPL','date_TPL','time_TPL')">Add to Cart</button>
      </div>
    </div>
    </div>

  <div class="mt-5">
    <h3>Booking Summary</h3>
    <div class="booking-summary list-group mb-3" id="bookingSummary">
      <div class="list-group-item">No packages added yet.</div>
    </div>
    <button class="btn btn-success w-100" id="checkoutBtn" onclick="checkout()" disabled>Proceed to Checkout</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // --- JAVASCRIPT/JQUERY FOR LOOPING AND ID MANAGEMENT ---
  $(document).ready(function() {
    const numPackages = 3;
    const $template = $('#package-template');
    const $container = $('#packageContainer');

    for (let i = 1; i <= numPackages; i++) {
      // 1. Clone the template
      const $newCard = $template.clone().removeAttr('id').show();

      // 2. Assign unique IDs to the form elements and update the button onclick
      const cardId = i; // Use the loop index as a unique identifier

      // Update IDs in the cloned element
      $newCard.find('#riders_TPL').attr('id', 'riders' + cardId);
      $newCard.find('#date_TPL').attr('id', 'date' + cardId);
      $newCard.find('#time_TPL').attr('id', 'time' + cardId);

      // Update <label for> attributes
      $newCard.find('label[for="riders_TPL"]').attr('for', 'riders' + cardId);
      $newCard.find('label[for="date_TPL"]').attr('for', 'date' + cardId);
      $newCard.find('label[for="time_TPL"]').attr('for', 'time' + cardId);

      // Update the button's onclick attribute with the new unique IDs
      const newOnClick = `addToCart('Explorer Adventure ${cardId}', 13900, 'riders${cardId}','date${cardId}','time${cardId}')`;
      $newCard.find('.btn-add-cart').attr('onclick', newOnClick).text(`Add Package ${cardId}`);

      // Optional: Update package title to show which one it is
      $newCard.find('.package-title').text(`Explorer Adventure Package ${cardId}`);

      // 3. Append to the container
      $container.append($newCard);
    }
  });


  // --- ORIGINAL JAVASCRIPT FUNCTIONS (Slightly modified to handle new titles) ---
  const cart = [];

  function addToCart(packageName, basePrice, ridersId, dateId, timeId) {
    // jQuery used for DOM selection in the original JS:
    const riders = $('#' + ridersId).val();
    const date = $('#' + dateId).val();
    const time = $('#' + timeId).val();

    if (!date) {
      alert('Please select a date!');
      return;
    }

    const item = { packageName, basePrice, riders, date, time };
    cart.push(item);
    renderCart();
  }

  function removeFromCart(index) {
    cart.splice(index, 1);
    renderCart();
  }

  function renderCart() {
    const summary = $('#bookingSummary');
    summary.empty(); // Use jQuery's empty() instead of innerHTML = ''

    if(cart.length === 0) {
      summary.html('<div class="list-group-item">No packages added yet.</div>'); // Use jQuery's html()
      $('#checkoutBtn').prop('disabled', true); // Use jQuery's prop()
      return;
    }

    cart.forEach((item, index) => {
      const price = item.basePrice * item.riders;
      const elHtml = `
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>${item.packageName}</strong><br>
            ${item.riders} Rider(s), ${item.date} at ${item.time} <br>
            Price: BDT ${price.toLocaleString()}
          </div>
          <div class="remove-item" onclick="removeFromCart(${index})">&times;</div>
        </div>
      `;
      summary.append(elHtml); // Use jQuery's append()
    });

    $('#checkoutBtn').prop('disabled', false);
  }

  function checkout() {
    let message = 'You have booked the following packages:\n\n';
    cart.forEach(item => {
      const price = item.basePrice * item.riders;
      message += `${item.packageName} - ${item.riders} Rider(s) - ${item.date} at ${item.time} - BDT ${price.toLocaleString()}\n`;
    });
    alert(message + '\nThank you for your booking!');
  }
</script>
</body>
</html>